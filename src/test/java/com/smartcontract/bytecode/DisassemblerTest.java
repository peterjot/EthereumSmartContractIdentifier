package com.smartcontract.bytecode;

import org.junit.Test;

import java.util.List;

import static org.hamcrest.core.IsEqual.equalTo;
import static org.junit.Assert.assertThat;

public class DisassemblerTest {


    private final Disassembler disassembler = new Disassembler();

    @Test
    public void shouldReturnAllInstructions() {
        //given
        int expectedInstructionsSize = 7916;
        String bytecode = "60806040523480156200001157600080fd5b5060405160408062004895833981018060405281019080805190602001909291908051906020019092919050505081818160008173ffffffffffffffffffffffffffffffffffffffff16141515156200006957600080fd5b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614151515620000e757600080fd5b80600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050506200016863b05049d97c01000000000000000000000000000000000000000000000000000000000283620001ae640100000000026401000000009004565b620001a6632fe7778c7c01000000000000000000000000000000000000000000000000000000000282620001ae640100000000026401000000009004565b5050620008f9565b600063bf2024547c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916141515156200028a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f4e465f554e495f4e4f5f554e4956455253455f53494e474c45544f4e0000000081525060200191505060405180910390fd5b60046000847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16141515620003fb576200034f8184620004dd640100000000026401000000009004565b6200036a8284620006ef640100000000026401000000009004565b8160046000857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b7fd9d686cb4410bad7b23b9666ac32a50a44214f46e0d910818d56ccc93e33820783838360405180847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a1505050565b60008060008073ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff1614156200051d57620006e8565b600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209250600183805490500390505b8082111515620006e757837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168383815481101515620005a257fe5b90600052602060002090600891828204019190066004029054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161415620006db5780821015620006bb5782818154811015156200061f57fe5b90600052602060002090600891828204019190066004029054906101000a90047c01000000000000000000000000000000000000000000000000000000000283838154811015156200066d57fe5b90600052602060002090600891828204019190066004026101000a81548163ffffffff02191690837c0100000000000000000000000000000000000000000000000000000000900402179055505b60018381818054905003915081620006d4919062000894565b50620006e8565b60018201915062000569565b5b5050505050565b600080600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1614156200072e576200088e565b600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002091505b81805490508110156200082357827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168282815481101515620007ac57fe5b90600052602060002090600891828204019190066004029054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916141562000817576200088e565b60018101905062000770565b8183908060018154018082558091505090600182039060005260206000209060089182820401919006600402909192909190916101000a81548163ffffffff02191690837c010000000000000000000000000000000000000000000000000000000090040217905550505b50505050565b815481835581811115620008cc576007016008900481600701600890048360005260206000209182019101620008cb9190620008d1565b5b505050565b620008f691905b80821115620008f2576000816000905550600101620008d8565b5090565b90565b613f8c80620009096000396000f3006080604052600436106101b7576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806304ac69c8146101bc5780630c7de42a14610213578063134e18f4146102a557806323dc2b57146102fc578063243ba0b7146103535780632dfb39fd146103cb57806334e3653b1461042257806349411557146104ba5780634ce63334146105115780634d51b6ff1461056857806350c5e6cb146105f45780635787563114610678578063636f6159146106db578063678e486b146107325780636fa00f07146107ed5780637655752814610844578063788517541461089b5780637b154313146109395780638291286c14610964578063870550081461099e5780638fb29d6c146109f5578063a1780ff314610adc578063b8066bcb14610b85578063c491607114610bdc578063c90f793e14610c33578063d7d847f514610d04578063e0f20a6514610d70578063e97b97fe14610dc7578063ea490b8414610e1e578063eb4e64d614610e75578063ebddfaad14610ede578063f40a80ea14610f62578063f5d60a5114610fb9578063f897d64714611010578063fcdc864214611067575b600080fd5b3480156101c857600080fd5b506101d1611153565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561021f57600080fd5b506102a360048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035151590602001909291905050506111ef565b005b3480156102b157600080fd5b506102ba611403565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561030857600080fd5b5061031161149f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561035f57600080fd5b506103c960048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19169060200190929190803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080351515906020019092919050505061153b565b005b3480156103d757600080fd5b506103e0611720565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561042e57600080fd5b50610463600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506117bc565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156104a657808201518184015260208101905061048b565b505050509050019250505060405180910390f35b3480156104c657600080fd5b506104cf6118b1565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561051d57600080fd5b5061052661194d565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561057457600080fd5b506105b260048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690602001909291905050506119e9565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561060057600080fd5b5061065e60048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611a64565b604051808215151515815260200191505060405180910390f35b34801561068457600080fd5b506106d9600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050611b0a565b005b3480156106e757600080fd5b506106f0611fc7565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561073e57600080fd5b5061079660048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050612063565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156107d95780820151818401526020810190506107be565b505050509050019250505060405180910390f35b3480156107f957600080fd5b5061082e600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061218d565b6040518082815260200191505060405180910390f35b34801561085057600080fd5b506108596121d6565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156108a757600080fd5b5061091f60048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612272565b604051808215151515815260200191505060405180910390f35b34801561094557600080fd5b5061094e612357565b6040518082815260200191505060405180910390f35b34801561097057600080fd5b50610979612364565b6040518083600019166000191681526020018281526020019250505060405180910390f35b3480156109aa57600080fd5b506109b361239b565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610a0157600080fd5b50610a2060048036038101908080359060200190929190505050612437565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200180602001838152602001828103825284818151815260200191508051906020019080838360005b83811015610a9e578082015181840152602081019050610a83565b50505050905090810190601f168015610acb5780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b348015610ae857600080fd5b50610b836004803603810190808035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050612539565b005b348015610b9157600080fd5b50610b9a612772565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610be857600080fd5b50610bf161280e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610c3f57600080fd5b50610c486128aa565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200180602001838152602001828103825284818151815260200191508051906020019080838360005b83811015610cc6578082015181840152602081019050610cab565b50505050905090810190601f168015610cf35780820380516001836020036101000a031916815260200191505b509550505050505060405180910390f35b348015610d1057600080fd5b50610d6e60048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19169060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506129cc565b005b348015610d7c57600080fd5b50610d85612baf565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610dd357600080fd5b50610ddc612c4b565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610e2a57600080fd5b50610e33612ce7565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610e8157600080fd5b50610edc600480360381019080803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050612d11565b005b348015610eea57600080fd5b50610f4860048036038101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612ed6565b604051808215151515815260200191505060405180910390f35b348015610f6e57600080fd5b50610f77612f80565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b348015610fc557600080fd5b50610fce61301c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561101c57600080fd5b506110256130b8565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561107357600080fd5b50611151600480360381019080803590602001908201803590602001908080602002602001604051908101604052809392919081815260200183836020028082843782019150505050505091929192908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919291929080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290505050613154565b005b60006004600063c6e5349e7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60007fe8d8f8f9ea4b19a5a4368dbdace17ad71a69aadeb6250e54c7b4c7b4463017386001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b15801561137f57600080fd5b505af1158015611393573d6000803e3d6000fd5b505050506040513d60208110156113a957600080fd5b810190808051906020019092919050505015156113c557600080fd5b5b84518210156113fc576113f185838151811015156113e057fe5b9060200190602002015185856133b6565b6001820191506113c6565b5050505050565b600060046000630a72e0737c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600060046000632fe7778c7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b7fe8d8f8f9ea4b19a5a4368dbdace17ad71a69aadeb6250e54c7b4c7b4463017386001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b1580156116c957600080fd5b505af11580156116dd573d6000803e3d6000fd5b505050506040513d60208110156116f357600080fd5b8101908080519060200190929190505050151561170f57600080fd5b61171a8484846133b6565b50505050565b6000600460006383c3790b7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6060600660008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208054806020026020016040519081016040528092919081815260200182805480156118a557602002820191906000526020600020906000905b82829054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190600401906020826003010492830192600103820291508084116118365790505b50505050509050919050565b60006004600063f4c848e87c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000600460006389dbc6de7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600060046000837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600060056000847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b60007fac42f8beb17975ed062dcb80c63e6d203ef1c2c335ced149dc5664cc671cb7da6001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b158015611c9a57600080fd5b505af1158015611cae573d6000803e3d6000fd5b505050506040513d6020811015611cc457600080fd5b81019080805190602001909291905050501515611ce057600080fd5b8373ffffffffffffffffffffffffffffffffffffffff16639085b77f847fac42f8beb17975ed062dcb80c63e6d203ef1c2c335ced149dc5664cc671cb7da600102306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b158015611e4c57600080fd5b505af1158015611e60573d6000803e3d6000fd5b505050506040513d6020811015611e7657600080fd5b81019080805190602001909291905050501515611e9257600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff169150836000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507f7d475c32583df95fccc34a6e12df24c1fc9943092cc129b6512013aecba0f136338386604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a150505050565b60006004600063ddd7a5217c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b606080600083516040519080825280602002602001820160405280156120985781602001602082028038833980820191505090505b5091505b8351811015612183576004600085838151811015156120b757fe5b906020019060200201517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16828281518110151561213c57fe5b9060200190602002019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505060018101905061209c565b8192505050919050565b6000600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b6000600460006336021e147c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000805b835181101561234b5760056000858381518110151561229157fe5b906020019060200201517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16156123405760019150612350565b600181019050612276565b600091505b5092915050565b6000600280549050905090565b6000807f8b57bfe21a3ef4854e19d702063b6cea03fa514162f8ff43fde551f06372fefd6000816001029150809050915091509091565b600060046000632347a19e7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600080606060008060028681548110151561244e57fe5b906000526020600020906003020190508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681600101548260020188818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156125225780601f106124f757610100808354040283529160200191612522565b820191906000526020600020905b81548152906001019060200180831161250557829003601f168201915b505050505091509450945094509450509193509193565b60007fe8d8f8f9ea4b19a5a4368dbdace17ad71a69aadeb6250e54c7b4c7b4463017386001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b1580156126c957600080fd5b505af11580156126dd573d6000803e3d6000fd5b505050506040513d60208110156126f357600080fd5b8101908080519060200190929190505050151561270f57600080fd5b8251845114151561271f57600080fd5b5b835182101561276c57612761848381518110151561273a57fe5b90602001906020020151848481518110151561275257fe5b906020019060200201516135e3565b600182019150612720565b50505050565b600060046000638cf73cf17c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000600460006375ecd7f87c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60008060606000806000806002805490501115156128c757600080fd5b60016002805490500391506002828154811015156128e157fe5b906000526020600020906003020190508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681600101548260020184818054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156129b55780601f1061298a576101008083540402835291602001916129b5565b820191906000526020600020905b81548152906001019060200180831161299857829003601f168201915b505050505091509550955095509550505090919293565b7fe8d8f8f9ea4b19a5a4368dbdace17ad71a69aadeb6250e54c7b4c7b4463017386001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b158015612b5a57600080fd5b505af1158015612b6e573d6000803e3d6000fd5b505050506040513d6020811015612b8457600080fd5b81019080805190602001909291905050501515612ba057600080fd5b612baa83836135e3565b505050565b60006004600063978a68237c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60006004600063eb41a1bd7c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b612d19613e49565b33612d23816138ee565b1515612d2e57600080fd5b6060604051908101604052803373ffffffffffffffffffffffffffffffffffffffff1681526020014281526020018481525091506002829080600181540180825580915050906001820390600052602060002090600302016000909192909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002019080519060200190612dfd929190613e81565b505050507fe9835ee18f0f0b190604da3474d67a8f29aba2c92e90eee2bdaeca67d40d5a6b3384604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200180602001828103825283818151815260200191508051906020019080838360005b83811015612e96578082015181840152602081019050612e7b565b50505050905090810190601f168015612ec35780820380516001836020036101000a031916815260200191505b50935050505060405180910390a1505050565b60008173ffffffffffffffffffffffffffffffffffffffff1660046000857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614905092915050565b60006004600063aa1590d07c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60006004600063b05049d97c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600060046000630b58f0067c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b60007fe8d8f8f9ea4b19a5a4368dbdace17ad71a69aadeb6250e54c7b4c7b4463017386001026000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639085b77f3383306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b1580156132e457600080fd5b505af11580156132f8573d6000803e3d6000fd5b505050506040513d602081101561330e57600080fd5b8101908080519060200190929190505050151561332a57600080fd5b8351855114151561333a57600080fd5b8251855114151561334a57600080fd5b5b84518210156133af576133a4858381518110151561336557fe5b90602001906020020151858481518110151561337d57fe5b90602001906020020151858581518110151561339557fe5b906020019060200201516133b6565b60018201915061334b565b5050505050565b80151560056000857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615151415613462576135de565b8060056000857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550801561351d576135188284613aa5565b613528565b6135278284613c43565b5b7f2e279d5a6e17c677f5c04cb7360516700d5e7dbaf5d918a8ed8558f32e8e338883838360405180847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182151515158152602001935050505060405180910390a15b505050565b600063bf2024547c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916141515156136be576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252601c8152602001807f4e465f554e495f4e4f5f554e4956455253455f53494e474c45544f4e0000000081525060200191505060405180910390fd5b60046000847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614151561380c576137718184613c43565b61377b8284613aa5565b8160046000857bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b7fd9d686cb4410bad7b23b9666ac32a50a44214f46e0d910818d56ccc93e33820783838360405180847bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001935050505060405180910390a1505050565b60006138f861301c565b73ffffffffffffffffffffffffffffffffffffffff16639085b77f837fb2b321377653f655206f71514ff9f150d0822d062a5abcf220d549e1da7999f0600102306000357fffffffff00000000000000000000000000000000000000000000000000000000166040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184600019166000191681526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001945050505050602060405180830381600087803b158015613a6357600080fd5b505af1158015613a77573d6000803e3d6000fd5b505050506040513d6020811015613a8d57600080fd5b81019080805190602001909291905050509050919050565b600080600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161415613ae257613c3d565b600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002091505b8180549050811015613bd257827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168282815481101515613b5e57fe5b90600052602060002090600891828204019190066004029054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161415613bc757613c3d565b600181019050613b24565b8183908060018154018082558091505090600182039060005260206000209060089182820401919006600402909192909190916101000a81548163ffffffff02191690837c010000000000000000000000000000000000000000000000000000000090040217905550505b50505050565b60008060008073ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff161415613c8157613e42565b600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209250600183805490500390505b8082111515613e4157837bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168383815481101515613d0457fe5b90600052602060002090600891828204019190066004029054906101000a90047c0100000000000000000000000000000000000000000000000000000000027bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161415613e365780821015613e19578281815481101515613d7e57fe5b90600052602060002090600891828204019190066004029054906101000a90047c0100000000000000000000000000000000000000000000000000000000028383815481101515613dcb57fe5b90600052602060002090600891828204019190066004026101000a81548163ffffffff02191690837c0100000000000000000000000000000000000000000000000000000000900402179055505b60018381818054905003915081613e309190613f01565b50613e42565b600182019150613ccd565b5b5050505050565b606060405190810160405280600073ffffffffffffffffffffffffffffffffffffffff16815260200160008152602001606081525090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10613ec257805160ff1916838001178555613ef0565b82800160010185558215613ef0579182015b82811115613eef578251825591602001919060010190613ed4565b5b509050613efd9190613f3b565b5090565b815481835581811115613f36576007016008900481600701600890048360005260206000209182019101613f359190613f3b565b5b505050565b613f5d91905b80821115613f59576000816000905550600101613f41565b5090565b905600a165627a7a72305820eb9d13d6368e3e22f198b67f007f6f34ecb857e25345d817e613112d1e31e9740029";

        //when
        List<Instruction> actualInstructions = disassembler.disassembly(bytecode);

        //then
        assertThat(actualInstructions.size(), equalTo(expectedInstructionsSize));
    }
}
